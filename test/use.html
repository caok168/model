<html>
    <head>
        <title></title>
        <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10"></script>
        <style>
            #loading-wrapper {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,.7);
                display: flex;
                justify-content: center;
                align-items: center;
                color: #fff;
            }
        </style>
    </head>
    <body>
        <div id="root">
            <button @click="showLoading">show loading</button>
        </div>
        <script>
            const loadingPlugin = {
                install(vm) {
                    const LoadingComponent = vm.extend({
                        template: '<div id="loading-wrapper">{{msg}}</div>',
                        props: {
                            msg: {
                                type: String,
                                default: 'loading...',
                            }
                        }
                    }, 'LoadingComponent')
                    function Loading(msg) {
                        const div = document.createElement('div')
                        div.setAttribute('id', 'loading-wrapper')
                        document.body.append(div)
                        new LoadingComponent({
                            props: {
                                msg: {
                                    type: String,
                                    default: msg,
                                }
                            }
                        }).$mount('#loading-wrapper')
                        return () => {
                            document.body.removeChild(document.getElementById('loading-wrapper'))
                        }
                    }
                    vm.prototype.$loading = Loading
                }
            }
            
            Vue.use(loadingPlugin)
            
            new Vue({
                el: '#root',
                methods: {
                    showLoading() {
                        const hide = this.$loading('正在加载，请稍后...')
                        setTimeout(() => {
                            hide()
                        }, 2000)
                    }
                }
            })
        </script>
    </body>
</html>
